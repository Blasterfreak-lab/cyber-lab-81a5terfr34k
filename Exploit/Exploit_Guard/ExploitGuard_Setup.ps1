# Windows Defender Exploit Guard - Full Deployment Script

# Aktivieren von Network Protection
Set-MpPreference -EnableNetworkProtection Enabled

# Kontrollierter Ordnerzugriff
Set-MpPreference -EnableControlledFolderAccess Enabled

# ASR-Regeln aktivieren (Beispiele)
$asrRules = @(
    "D4F940AB-401B-4EFC-AADC-AD5F3C50688A",  # Office Makros aus Internet blockieren
    "3B576869-A4EC-4529-8536-B80A7769E899",  # Skriptausführung durch Office-Anwendungen verhindern
    "75668C1F-73B5-4CF0-BB93-3ECF5CB7CC84",  # Ausführen von nicht signierten EXEs im Download-Verzeichnis blockieren
    "26190899-1602-49E8-8B27-EB1D0A1CE869"   # Credential-Stealing blockieren
)

foreach ($rule in $asrRules) {
    Add-MpPreference -AttackSurfaceReductionRules_Ids $rule -AttackSurfaceReductionRules_Actions Enabled
}
